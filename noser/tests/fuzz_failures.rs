use noser::traits::*;
use noser::{List, Literal};

#[test]
fn crash() {
    if let Ok(list) = List::<List<'_, Literal<'_, char>>>::create(&mut [
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    ]) {
        list.borrow(0);
    }
}

#[test]
fn crash2() {
    if let Ok(list) = List::<List<'_, Literal<'_, char>>>::create(&mut [
        0x01, 0x01, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00,
    ]) {
        list.borrow(0);
    }
}

#[test]
fn crash3() {
    if let Ok(list) = List::<List<'_, Literal<'_, char>>>::create(&mut [
        0x1, 0x0, 0x0, 0x0, 0x0, 0xfc, 0xff, 0xff, 0x4, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
        0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0xf6, 0xf7, 0x0, 0x0,
    ]) {
        list.borrow(0);
    }
}

#[test]
fn crash4() {
    if let Ok(lit) = Literal::<&[u8]>::create(&mut [
        0xa, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
        0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
        0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
        0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
        0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
        0x0, 0x0, 0x0,
    ]) {
        lit.read();
    }
}

#[test]
fn crash5() {
    if let Ok(lit) = Literal::<&[u8]>::create(&mut [
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xa,
        0xa,
    ]) {
        lit.read();
    }
}
